---
layout: post
title: 从100万空文件占用空间大小看Linux文件系统结构
categories: 案例实验
tags: 存储
---

* content
{:toc}

空目录占用，当一个目录中包含100万个空文件时，目录会占用多大的空间？



## 1. 背景

系统A使用空文件来标记模块数量，正常情况模块不会太多。但由于误用和边界限制不完备，标记空文件生成了一千万个，导致了这个目录很大，造成系统异常。

本博客对单目录创建大量空文件的情况进行实验，结合Linux不同文件系统的实现进行对比加深理解。

## 实验

### mac系统

* 步骤：

    1. 新建一个临时目录tmp1，`ls -l`查看目录信息：
        `drwxr-xr-x      2 xd  staff    64B  6 30 11:31 tmp1`
    2. 新建目录tmp2，创建1万空文件 `for ((i=0; i<10000; i++)); do touch $i; done`
        `drwxr-xr-x  10002 xd  staff    320064  6 30 11:39 tmp2`

* 分析

    Mac系统中为Apple自研文件系统APFS


## 3. 小结


## 参考

1. 
